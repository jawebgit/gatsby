// Generated by CoffeeScript 1.9.0
(function() {
  var MarkdownIt, frontMatter, fs, highlight, hljs, md, _;

  fs = require('fs');

  frontMatter = require('front-matter');

  MarkdownIt = require('markdown-it');

  hljs = require('highlight.js');

  _ = require('underscore');

  highlight = function(str, lang) {
    if ((lang != null) && hljs.getLanguage(lang)) {
      try {
        return hljs.highlight(lang, str).value;
      } catch (_error) {

      }
    }
    try {
      return hljs.highlightAuto(str).value;
    } catch (_error) {

    }
    return '';
  };

  md = MarkdownIt({
    html: true,
    linkify: true,
    typographer: true,
    highlight: highlight
  });

  module.exports = function(content) {
    var body;
    this.cacheable();
    content = frontMatter(content);
    body = md.render(content.body);
    content = _.extend({}, content.attributes, {
      body: body
    });
    this.value = content;
    return 'module.exports = ' + JSON.stringify(content);
  };

}).call(this);
