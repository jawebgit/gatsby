// Generated by CoffeeScript 1.9.0
(function() {
  var Router, globPages, loaderUtils, path, toml;

  toml = require('toml');

  loaderUtils = require('loader-utils');

  Router = require('react-router');

  path = require('path');

  globPages = require('../../utils/glob-pages');

  module.exports = function(source) {
    var callback, config, directory, value;
    this.cacheable();
    callback = this.async();
    value = {};
    directory = loaderUtils.parseQuery(this.query).directory;
    config = toml.parse(source);
    value.config = config;
    value.relativePath = path.relative('.', directory);
    return globPages(directory, (function(_this) {
      return function(err, pagesData) {
        value.pages = pagesData;
        _this.value = [value];
        return callback(null, 'module.exports = ' + JSON.stringify(value, void 0, "\t"));
      };
    })(this));
  };

}).call(this);
